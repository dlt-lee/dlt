library(HMM)


rows<-dim(dlt)[1]
line<-rows-98
n<-c(0,0,0,0,0,0,0,0)

for (i in 1:50) {
  start<-line-609
  data<-dlt[start:line,]
  temp<-dlt_sum_L2(data)
  n<-c(n,(dlt[line,]$n+1),temp)
  start<-start+1
  line<-line+1
}
n_m<-matrix(n,ncol = 8,byrow = TRUE)
cell<-c(  19042,09,11,16,21,30,05,12,
          19043,02,13,16,24,31,03,10,
          19045,06,09,22,25,31,04,09,
          19046,04,10,14,18,30,02,10,
          19047,06,10,13,20,31,06,09,
          19048,03,09,13,23,30,05,09,
          19049,04,07,09,18,30,01,08,
          19050,03,09,15,25,26,04,06,
          19051,04,11,20,24,31,03,04,
          19052,06,07,21,24,27,02,11,
          19053,01,14,19,23,33,02,08,
          19054,03,13,22,27,27,05,09,
          19055,06,08,18,28,30,05,08,
          19056,04,08,20,25,30,04,07,
          19057,05,09,21,28,31,05,11,
          19058,06,07,11,25,32,02,09,
          19059,10,10,16,26,33,04,11, 
          19060,08,14,21,26,29,02,09,
          19061,11,14,17,24,25,03,06,
          19062,06,11,13,25,27,04,07,
          19063,05,07,16,19,26,06,09,
          19064,05,09,15,21,27,05,10,
          19065,06,08,20,28,28,-1,10,
          19066,05,11,20,18,27,05,08,
          19067,05,09,25,28,30,04,10,
          19068,10,14,19,26,28,04,09,
          19069,04,06,14,25,32,04,04,
          19070,05,11,15,17,33,05,09,
          19071,05,15,15,22,34,05,08,
          19072,02,14,21,28,31,00,10,
          19073,08,13,15,24,26,04,07,
          19074,06,13,23,23,23,03,10,
          19075,02,11,17,22,30,06,10,
          19076,11,14,17,18,32,03,12,
          19077,04,15,19,22,31,01,10,
          19078,02,16,23,20,31,02,08,
          19079,03,14,17,24,32,05,07,
          19080,07,12,24,24,30,04,10,
          19081,03,07,19,21,30,04,09,
          19082,07,09,15,27,31,04,07,
          19083,05,12,15,25,28,03,07,
          19084,07,11,19,22,31,04,07,
          19085,04,09,11,13,24,02,10,
          19086,05,16,23,20,22,08,09,
          19087,05,08,12,25,29,05,09,
          19088,05,12,23,25,28,03,09,
          19089,07,12,18,20,35,05,06,
          19090,15,16,16,18,30,01,11,
          19091,04,13,25,16,33,04,07,
          19092,34,06,12,15,30,05,10
             )
ab_m<-matrix(cell,ncol = 8,byrow = TRUE)

#构建HMM回归模型
states<-c("s1","s2","s3","s4","s5")
numstates<-length(states)
numstates<-length(states)
symbols<- c(01,02,03,04,05,06,07,08,09,10,
            11,12,13,14,15,16,17,18,19,20,
            21,22,23,24,25,26,27,28,29,30,
            31,32,33,34,35)
numsymbols<-length(symbols)

emissionProbilities<-matrix(runif(numstates*numsymbols),numstates,numsymbols)
emissionProbilities<-sweep(emissionProbilities,1,
                           rowSums(emissionProbilities),FUN = "/")

hmm<-initHMM(states,symbols,startProbs = startingProbabilities,
             emissionProbs = emissionProbilities)