library(Hmisc)
library(psych)
library(pastecs)
library(doBy)
library(reshape2)
library(vcd)
library(gmodels)
library(ca)
library(ggm)
library(plotrix)
library(polycor)
library(Rgraphviz)
library(kknn)
library(FNN)
#library(gmp)
library(bnlearn)
library(klaR)
library(gRain)
library(lattice)
library(ggplot2)
library(caret)
library(rpart)
library(rpart.plot)
library(randomForest)
library(e1071)
library(gbm)
library(glmnet)
library(adabag)
library(xgboost)
library(readr)
library(stringr)
library(caret)
library(car)
library(glmnet)
library(doParallel)
library(mclust)
library(HiddenMarkov)
library(depmixS4)
library(recommenderlab)
library(nnet)
library(caret)


rnames<-c("number","a1","a2","a3","a4","a5","b1","b2")
cnames<-c()
cell_2015<-c(15001,8,9,19,27,30,6,7,
             15002,3,14,20,26,32,6,10,
             15003,12,19,27,28,34,1,12,
             15004,3,12,14,18,28,5,6,
             15005,11,14,15,18,19,7,8,
             15006,6,8,30,32,33,3,7,
             15007,2,7,8,14,31,4,8,
             15008,7,10,11,15,17,3,10,
             15009,17,22,26,27,33,6,10,
             15010,2,6,17,30,35,2,7,
             15011,4,13,22,25,30,1,6,
             15012,3,4,6,11,31,5,9,
             15013,11,15,25,28,35,7,10,
             15014,8,16,25,29,35,3,10,
             15015,1,5,13,17,32,4,11,
             15016,6,7,16,20,34,9,11,
             15017,7,13,16,17,29,1,7,
             15018,4,7,10,23,31,3,7,
             15019,2,8,16,22,24,1,3,
             15020,11,26,28,29,32,1,4,
             15021,22,23,24,26,31,5,6,
             15022,9,11,14,15,26,11,12,
             15023,6,9,11,12,22,3,11,
             15024,2,6,8,16,34,3,4,
             15025,7,10,20,22,27,10,11,
             15026,11,13,14,15,22,2,8,
             15027,5,21,22,25,28,3,10,
             15028,3,9,28,32,33,9,10,
             15029,7,10,19,30,35,3,5,
             15030,9,18,19,26,31,2,5,
             15031,7,21,29,32,33,4,12,
             15032,6,21,25,27,30,7,11,
             15033,3,17,22,26,28,3,7,
             15034,4,8,15,18,26,5,9,
             15035,22,24,29,30,35,1,10,
             15036,14,18,20,23,24,4,8,
             15037,10,16,21,28,31,7,8,
             15038,12,19,22,31,35,7,8,
             15039,3,6,7,16,25,1,6,
             15040,2,9,10,23,35,9,12,
             15041,1,11,21,23,28,1,10,
             15042,3,7,12,17,24,2,11,
             15043,2,20,22,25,29,2,7,
             15044,16,18,27,31,33,1,3,
             15045,8,9,22,29,30,8,12,
             15046,5,7,10,22,26,4,10,
             15047,1,2,17,23,31,5,12,
             15048,10,11,22,24,33,2,9,
             15049,8,9,11,15,22,8,10,
             15050,6,7,10,20,28,2,7,
             15051,1,2,11,16,21,1,5,
             15052,13,19,24,27,29,7,8,
             15053,8,25,28,29,32,4,7,
             15054,2,9,15,24,34,3,9,
             15055,6,11,14,20,30,5,10,
             15056,6,12,19,26,35,3,10,
             15057,1,5,7,14,26,4,6,
             15058,10,14,20,27,30,7,12,
             15059,7,9,19,23,32,1,3,
             15060,16,24,25,26,33,4,11,
             15061,6,7,8,16,22,2,10,
             15062,6,7,13,14,15,1,4,
             15063,1,4,6,34,35,2,4,
             15064,2,8,20,28,31,7,10,
             15065,4,5,7,13,35,8,11,
             15066,1,3,7,13,29,2,10,
             15067,4,10,18,24,27,4,11,
             15068,2,3,20,31,35,4,8,
             15069,2,9,11,22,25,1,7,
             15070,3,9,12,17,18,4,12,
             15071,4,6,13,16,34,4,10,
             15072,19,20,21,31,33,9,10,
             15073,9,26,27,30,34,1,6,
             15074,1,12,21,27,33,4,9,
             15075,13,14,26,27,33,10,12,
             15076,3,19,21,31,34,5,12,
             15077,1,16,17,22,28,2,9,
             15078,19,24,26,28,33,1,2,
             15079,1,9,17,23,24,4,5,
             15080,14,20,29,30,32,3,8,
             15081,3,4,10,13,17,5,9,
             15082,8,15,28,31,33,3,6,
             15083,14,16,19,25,29,10,12,
             15084,10,20,21,32,34,6,7,
             15085,2,3,4,6,16,3,12,
             15086,5,9,11,15,32,4,9,
             15087,2,5,15,17,22,1,11,
             15088,5,15,28,31,34,11,12,
             15089,5,12,18,20,27,10,12,
             15090,6,9,11,17,21,6,8,
             15091,2,7,28,29,30,3,7,
             15092,2,14,21,27,34,5,8,
             15093,16,17,25,26,27,2,4,
             15094,2,3,10,11,29,3,7,
             15095,8,14,26,34,35,5,10,
             15096,3,9,12,18,21,2,6,
             15097,4,16,17,26,27,1,4,
             15098,9,14,21,27,33,6,9,
             15099,9,12,14,22,25,5,10,
             15100,9,15,18,23,32,5,7,
             15101,6,12,17,18,32,7,12,
             15102,11,14,15,33,34,3,12,
             15103,7,9,15,25,34,4,10,
             15104,16,19,25,30,34,4,9,
             15105,8,9,15,21,27,5,9,
             15106,2,11,13,22,30,2,3,
             15107,3,23,25,28,29,6,7,
             15108,1,13,16,26,31,7,12,
             15109,1,6,11,22,31,3,12,
             15110,2,7,10,22,30,7,11,
             15111,7,8,16,24,28,3,10,
             15112,4,5,15,19,28,4,11,
             15113,1,14,21,29,33,2,10,
             15114,9,18,24,31,34,2,10,
             15115,8,12,13,14,16,3,9,
             15116,7,10,19,24,33,3,7,
             15117,6,17,20,30,33,10,11,
             15118,3,7,20,24,31,4,9,
             15119,1,8,12,16,21,6,11,
             15120,1,9,15,24,32,5,10,
             15121,2,4,17,27,28,4,6,
             15122,11,13,15,26,35,6,11,
             15123,4,15,27,29,30,2,10,
             15124,4,6,12,31,32,3,6,
             15125,2,3,15,17,28,8,10,
             15126,4,5,8,9,21,3,6,
             15127,9,11,14,19,30,3,8,
             15128,10,12,23,30,32,3,4,
             15129,1,6,23,25,29,3,9,
             15130,17,25,31,32,34,2,12,
             15131,11,17,19,20,27,2,3,
             15132,3,8,14,18,27,1,5,
             15133,3,7,8,25,30,4,8,
             15134,1,2,6,15,35,4,7,
             15135,5,16,20,25,29,6,8,
             15136,5,20,23,29,32,2,10,
             15137,14,17,21,23,26,8,11,
             15138,1,16,20,29,32,4,7,
             15139,2,3,5,25,32,5,7,
             15140,1,11,15,26,35,6,11,
             15141,2,4,15,19,31,2,3,
             15142,12,14,22,26,30,3,6,
             15143,9,20,31,33,35,10,11,
             15144,1,9,24,26,29,6,11,
             15145,6,7,20,29,32,11,12,
             15146,4,15,19,27,31,4,11,
             15147,1,2,13,18,19,8,10,
             15148,8,11,27,31,33,8,9,
             15149,4,6,10,12,28,2,8,
             15150,4,13,18,25,33,3,7,
             15151,15,16,18,30,35,1,7,
             15152,4,5,22,29,35,2,11,
             15153,1,7,22,27,33,2,11)
m_2015<-matrix(cell_2015,ncol=8,byrow = TRUE,dimnames = list(cnames,rnames))
cell_2016<-c(16001,1,7,19,20,30,5,10,
             16002,7,12,18,25,35,7,9,
             16003,4,12,17,22,26,6,7,
             16004,10,20,23,32,35,9,10,
             16005,6,9,12,15,20,8,11,
             16006,14,16,17,22,24,2,9,
             16007,2,5,14,32,35,1,3,
             16008,5,12,31,34,35,4,5,
             16009,5,8,10,17,20,2,12,
             16010,12,13,15,16,28,2,5,
             16011,2,8,10,15,23,5,10,
             16012,5,7,11,23,28,3,12,
             16013,3,21,23,31,35,2,11,
             16014,6,8,21,24,27,2,10,
             16015,1,4,10,13,30,3,9,
             16016,3,10,22,29,32,2,5,
             16017,11,18,24,28,29,5,10,
             16018,5,10,13,27,33,8,11,
             16019,4,11,15,20,26,8,9,
             16020,1,16,22,29,30,2,9,
             16021,1,4,9,10,35,9,11,
             16022,4,18,21,30,35,2,11,
             16023,4,9,14,25,27,6,11,
             16024,1,2,11,15,18,4,8,
             16025,3,6,13,23,24,7,10,
             16026,2,6,29,30,34,1,7,
             16027,6,11,13,15,28,2,6,
             16028,13,18,20,23,31,3,6,
             16029,20,26,27,29,32,5,12,
             16030,10,19,21,29,33,4,6,
             16031,3,14,24,27,29,4,11,
             16032,5,9,14,20,33,5,12,
             16033,3,14,15,31,35,9,10,
             16034,14,18,31,32,35,9,10,
             16035,17,22,24,25,29,9,12,
             16036,7,15,26,30,31,3,6,
             16037,3,5,13,24,34,3,5,
             16038,3,7,9,15,33,5,12,
             16039,1,8,16,22,28,4,5,
             16040,20,22,29,30,35,1,6,
             16041,12,23,24,27,34,3,6,
             16042,2,6,8,19,24,1,6,
             16043,1,9,16,33,34,9,12,
             16044,1,6,10,20,31,5,11,
             16045,7,11,25,30,33,2,8,
             16046,3,19,22,32,34,8,12,
             16047,2,3,23,29,32,5,9,
             16048,4,12,17,25,27,4,10,
             16049,3,4,5,27,33,4,9,
             16050,7,17,21,29,35,4,5,
             16051,16,21,23,34,32,7,8,
             16052,8,14,19,20,33,10,11,
             16053,4,13,15,30,35,3,5,
             16054,2,5,9,21,30,6,7,
             16055,6,21,27,30,34,4,9,
             16056,10,12,14,31,35,4,5,
             16057,8,17,19,23,30,3,8,
             16058,2,15,17,23,28,5,9,
             16059,2,10,27,28,33,5,7,
             16060,2,6,22,27,34,8,11,
             16061,9,15,17,21,23,7,12,
             16062,2,10,14,15,35,1,9,
             16063,8,12,22,27,35,5,9,
             16064,1,2,10,18,35,5,11,
             16065,1,9,18,22,24,11,12,
             16066,10,28,29,31,33,5,11,
             16067,2,8,11,13,19,2,8,
             16068,5,7,22,26,34,7,12,
             16069,14,17,19,23,30,2,9,
             16070,2,9,13,19,23,5,7,
             16071,8,15,19,20,33,7,12,
             16072,16,20,24,26,31,4,9,
             16073,7,14,17,24,27,8,10,
             16074,1,5,7,11,14,3,8,
             16075,3,7,17,22,31,8,12,
             16076,3,8,10,17,31,5,6,
             16077,9,11,14,16,35,2,5,
             16078,7,18,29,31,35,5,11,
             16079,7,14,15,20,27,5,10,
             16080,15,20,29,30,33,7,12,
             16081,6,7,18,21,33,3,8,
             16082,3,8,23,28,29,2,7,
             16083,1,5,9,33,35,1,5,
             16084,8,12,15,26,35,1,8,
             16085,14,15,27,31,32,1,7,
             16086,3,5,22,25,30,7,9,
             16087,3,16,17,23,25,7,9,
             16088,4,16,17,21,30,6,11,
             16089,7,14,17,28,34,7,10,
             16090,4,6,8,28,32,7,12,
             16091,8,13,17,21,22,2,8,
             16092,2,13,31,33,34,7,11,
             16093,1,8,14,30,35,6,7,
             16094,1,14,16,17,18,5,7,
             16095,8,12,18,19,21,3,6,
             16096,1,6,8,12,21,5,10,
             16097,6,8,18,31,33,10,12,
             16098,8,9,11,20,29,4,5,
             16099,3,4,12,14,27,1,5,
             16100,8,12,19,26,30,2,12,
             16101,4,6,28,33,35,7,12,
             16102,3,5,6,34,35,3,12,
             16103,5,14,20,23,29,3,11,
             16104,1,20,22,23,30,6,7,
             16105,8,11,31,34,35,1,2,
             16106,3,21,30,33,35,1,4,
             16107,2,6,19,24,26,4,6,
             16108,10,17,22,23,25,7,9,
             16109,3,25,28,31,34,11,12,
             16110,7,20,21,23,30,7,10,
             16111,1,9,22,26,27,2,12,
             16112,7,22,23,31,32,4,5,
             16113,10,11,17,30,34,3,12,
             16114,16,17,20,32,33,3,7,
             16115,1,4,15,31,34,2,11,
             16116,4,6,8,19,34,10,12,
             16117,3,9,14,16,23,2,9,
             16118,12,15,18,24,29,3,11,
             16119,2,3,9,21,22,5,10,
             16120,3,10,20,32,34,4,7,
             16121,4,5,8,15,20,1,6,
             16122,1,3,12,14,29,2,6,
             16123,4,5,13,20,32,1,10,
             16124,4,13,24,26,29,8,11,
             16125,6,7,8,28,30,1,2,
             16126,11,13,16,19,24,6,8,
             16127,1,5,15,24,26,9,10,
             16128,17,20,22,30,33,7,8,
             16129,7,8,19,30,35,8,9,
             16130,11,23,32,33,34,1,12,
             16131,6,13,25,28,30,2,7,
             16132,4,18,19,22,35,1,2,
             16133,1,4,5,23,28,5,9,
             16134,1,3,31,33,34,2,7,
             16135,1,10,12,18,35,1,12,
             16136,5,6,7,19,23,4,11,
             16137,7,20,23,29,34,2,10,
             16138,12,13,16,29,35,5,11,
             16139,13,21,30,31,35,1,8,
             16140,12,16,23,29,34,4,11,
             16141,2,6,7,19,28,11,12,
             16142,1,6,17,23,26,6,12,
             16143,4,6,22,27,31,6,7,
             16144,4,5,13,22,31,5,10,
             16145,1,9,11,17,28,3,8,
             16146,21,22,25,29,34,1,11,
             16147,7,19,20,28,30,4,12,
             16148,5,14,15,23,25,6,8,
             16149,1,2,3,12,33,4,9,
             16150,1,10,18,24,29,7,10,
             16151,4,7,11,14,21,5,12,
             16152,8,17,22,24,30,5,11,
             16153,13,18,25,29,35,3,11,
             16154,6,16,17,21,29,4,6)
m_2016<-matrix(cell_2016,ncol = 8,byrow = TRUE,dimnames = list(cnames,rnames))
cell_2017<-c(17001,7,9,20,31,33,8,10,
             17002,7,12,14,31,34,9,11,
             17003,3,5,6,13,22,9,12,
             17004,5,8,11,28,31,6,7,
             17005,5,9,20,26,35,2,11,
             17006,5,9,20,26,35,2,11,
             17007,8,11,17,25,27,2,4,
             17008,3,4,9,25,32,2,4,
             17009,5,6,8,12,22,3,4,
             17010,4,10,13,18,35,1,2,
             17011,5,15,21,29,34,6,9,
             17012,4,5,24,26,35,7,12,
             17013,5,12,17,30,34,11,12,
             17014,4,8,15,24,25,2,5,
             17015,1,7,19,27,34,1,2,
             17016,3,13,28,30,33,9,10,
             17017,4,19,24,26,29,4,6,
             17018,6,7,10,17,23,1,9,
             17019,2,6,14,23,25,2,10,
             17020,16,21,24,27,28,4,7,
             17021,1,15,17,20,26,6,8,
             17022,2,3,9,17,24,6,12,
             17023,5,8,12,24,34,7,10,
             17024,21,23,29,32,35,11,12,
             17025,10,16,19,20,34,4,5,
             17026,10,14,19,25,32,2,7,
             17027,8,17,25,33,34,3,11,
             17028,6,18,22,23,33,9,11,
             17029,1,6,14,17,29,1,11,
             17030,21,22,24,29,34,5,6,
             17031,2,16,17,30,32,2,9,
             17032,2,13,14,18,29,3,9,
             17033,15,22,23,25,34,5,11,
             17034,6,12,21,26,29,2,11,
             17035,14,17,22,30,33,7,12,
             17036,1,4,9,18,33,2,5,
             17037,13,15,16,32,34,6,11,
             17038,4,5,13,18,27,3,9,
             17039,5,6,14,17,26,3,8,
             17040,4,6,10,23,29,9,11,
             17041,2,4,6,25,31,5,9,
             17042,2,17,31,33,34,1,7,
             17043,6,13,22,25,35,9,12,
             17044,11,16,17,18,25,2,9,
             17045,1,8,11,21,35,9,12,
             17046,4,17,20,23,30,2,3,
             17047,15,19,32,33,34,9,12,
             17048,7,9,13,15,19,3,10,
             17049,9,12,14,22,31,5,8,
             17050,12,14,17,20,28,2,6,
             17051,14,17,18,22,29,10,11,
             17052,3,19,24,28,33,4,12,
             17053,6,19,20,22,26,1,11,
             17054,16,29,30,32,33,4,5,
             17055,19,20,22,30,33,3,9,
             17056,1,4,24,27,32,3,10,
             17057,12,16,19,23,24,2,5,
             17058,14,18,20,21,28,3,6,
             17059,8,11,13,15,17,3,10,
             17060,9,15,20,26,31,5,12,
             17061,10,19,23,25,30,2,4,
             17062,1,4,6,8,28,8,12,
             17063,18,21,22,24,29,5,11,
             17064,1,8,20,27,30,3,4,
             17065,5,11,12,19,28,5,12,
             17066,11,15,23,26,30,2,11,
             17067,10,17,18,32,35,10,11,
             17068,7,8,19,24,27,6,7,
             17069,10,16,20,23,32,8,11,
             17070,6,16,18,26,30,2,3,
             17071,1,4,11,14,33,5,7,
             17072,1,3,29,32,34,2,5,
             17073,7,18,28,31,33,1,2,
             17074,8,10,11,13,17,8,11,
             17075,5,11,16,18,35,1,6,
             17076,2,7,25,30,35,7,12,
             17077,1,3,4,25,31,6,9,
             17078,4,5,27,31,34,3,6,
             17079,1,17,19,32,33,2,11,
             17080,8,10,21,30,31,2,5,
             17081,2,12,15,20,34,1,6,
             17082,5,13,20,21,25,8,9,
             17083,2,5,14,22,34,3,9,
             17084,6,11,14,21,31,9,12,
             17085,9,13,14,25,30,2,5,
             17086,12,15,18,22,31,1,8,
             17087,3,14,21,29,35,2,6,
             17088,5,28,31,34,35,8,9,
             17089,3,5,6,15,18,3,10,
             17090,3,6,15,22,35,9,11,
             17091,1,5,7,16,19,3,12,
             17092,3,7,9,17,34,4,5,
             17093,5,6,17,21,29,2,4,
             17094,3,5,8,29,33,4,8,
             17095,15,32,33,34,35,3,12,
             17096,3,7,9,17,28,4,12,
             17097,7,14,19,22,34,7,12,
             17098,6,9,17,30,35,10,11,
             17099,8,9,17,18,24,3,7,
             17100,2,5,18,19,31,1,9,
             17101,5,15,21,25,29,5,8,
             17102,1,12,23,24,29,8,12,
             17103,4,19,20,24,29,3,4,
             17104,9,11,22,27,30,9,11,
             17105,4,15,22,24,32,2,9,
             17106,9,12,18,23,29,2,4,
             17107,4,10,19,25,27,6,12,
             17108,1,4,15,21,22,4,9,
             17109,6,9,19,26,34,5,7,
             17110,10,14,20,21,35,2,5,
             17111,2,14,17,26,34,8,12,
             17112,5,6,20,31,32,6,12,
             17113,5,8,17,18,23,4,12,
             17114,6,7,12,18,23,1,12,
             17115,14,19,20,25,31,6,8,
             17116,2,27,30,32,33,1,3,
             17117,5,7,9,24,32,8,10,
             17118,2,7,16,20,33,3,11,
             17119,5,7,13,29,35,3,8,
             17120,8,15,24,26,27,5,6,
             17121,1,6,12,26,31,1,7,
             17122,3,12,18,29,34,3,11,
             17123,3,15,23,26,32,1,12,
             17124,3,29,30,32,35,3,8,
             17125,7,11,18,26,28,4,5,
             17126,3,4,13,24,33,1,11,
             17127,2,15,18,21,22,3,10,
             17128,9,11,13,18,33,2,3,
             17129,5,17,20,32,33,4,9,
             17130,5,18,28,33,34,3,4,
             17131,3,5,8,19,34,1,12,
             17132,11,17,23,26,27,1,10,
             17133,15,17,19,32,33,1,3,
             17134,7,18,19,32,34,2,10,
             17135,1,12,15,19,22,2,4,
             17136,1,11,20,21,22,3,4,
             17137,1,20,22,28,29,5,7,
             17138,4,7,9,20,25,2,11,
             17139,2,6,19,25,32,9,12,
             17140,10,16,25,26,29,1,5,
             17141,2,8,21,22,29,3,5,
             17142,1,5,16,19,28,2,10,
             17143,6,9,24,29,32,2,7,
             17144,3,21,23,29,32,10,11,
             17145,4,7,17,18,19,3,10,
             17146,1,5,11,14,35,9,10,
             17147,5,16,17,25,34,1,11,
             17148,19,27,31,32,35,11,12,
             17149,10,18,19,25,26,4,12,
             17150,3,6,10,13,18,9,11,
             17151,5,6,23,28,32,4,5,
             17152,2,4,7,23,28,2,8,
             17153,1,9,24,26,34,9,12
)
m_2017<-matrix(cell_2017,ncol = 8,byrow = TRUE,dimnames = list(cnames,rnames))
cell_2018<-c( 18001,01,13,22,25,35,3,04,
              18002,12,20,23,27,34,1,06,
              18003,04,21,23,24,30,9,10,
              18004,04,09,22,28,30,1,10,
              18005,04,09,23,24,30,8,11,
              18006,19,20,30,32,33,3,05,
              18007,03,04,28,31,34,4,11,
              18008,09,15,17,20,22,10,11,
              18009,10,12,28,30,34,03,04,
              18010,24,25,26,28,29,04,12,
              18011,03,13,15,23,26,01,10,
              18012,03,22,24,29,34,07,11,
              18013,08,24,31,33,35,07,10,
              18014,14,16,18,24,31,01,08,
              18015,04,13,15,18,29,05,11,
              18016,01,02,12,13,23,09,12,
              18017,04,19,21,23,31,04,09,
              18018,06,08,13,24,28,06,12,
              18019,10,11,19,21,28,05,12,
              18020,01,10,13,14,21,09,12,
              18021,05,06,08,09,15,04,11,
              18022,02,10,19,33,35,05,06,
              18023,12,13,18,21,29,02,08,
              18024,02,16,24,30,32,04,07,
              18025,07,08,09,15,34,07,08,
              18026,01,02,03,04,30,03,05,
              18027,01,18,20,21,26,04,11,
              18028,04,19,25,30,35,04,07,
              18029,03,09,21,25,29,01,08,
              18030,05,18,21,28,32,09,11,
              18031,03,08,13,17,23,05,11,
              18032,07,10,17,32,35,05,12,
              18033,02,03,19,23,34,04,09,
              18034,08,11,22,27,32,03,07,
              18035,05,07,10,12,24,07,11,
              18036,11,17,18,21,27,07,08,
              18037,01,03,27,30,31,02,11,
              18038,14,23,25,31,32,01,03,
              18039,02,07,14,29,32,10,11,
              18040,05,07,18,27,31,01,08,
              18041,01,23,25,31,33,01,12,
              18042,03,19,25,29,35,05,09,
              18043,03,06,13,28,33,04,11,
              18044,02,04,06,18,21,05,08,
              18045,02,05,20,30,35,05,09,
              18046,10,20,22,29,32,05,10,
              18047,03,08,10,14,20,04,08,
              18048,02,03,11,20,25,02,07,
              18049,04,07,09,10,13,06,12,
              18050,22,24,26,34,35,06,12,
              18051,09,18,28,29,35,03,11,
              18052,05,16,18,19,25,02,07,
              18053,11,16,21,23,25,02,12,
              18054,09,10,12,20,30,01,07,
              18055,03,07,20,33,34,09,10,
              18056,02,04,16,28,34,05,07,
              18057,13,19,22,27,28,05,06,
              18058,09,11,12,26,32,04,10,
              18059,01,09,10,27,35,06,11,
              18060,04,22,27,29,31,02,10,
              18061,04,10,12,28,31,08,11,
              18062,12,14,19,23,35,02,07,
              18063,05,14,15,32,34,03,10,
              18064,01,03,04,11,29,02,04,
              18065,07,10,28,31,32,08,10,
              18066,01,20,23,32,33,01,04,
              18067,03,07,12,18,31,07,10,
              18068,08,12,16,26,33,05,06,
              18069,01,08,13,21,24,02,11,
              18070,02,05,10,16,30,04,07,
              18071,02,05,23,30,31,03,09,
              18072,05,12,17,24,26,01,02,
              18073,13,19,24,25,29,02,08,
              18074,03,09,12,28,30,04,12,
              18075,01,06,12,20,34,04,12,
              18076,07,18,28,29,32,06,08,
              18077,01,06,09,15,26,08,09,
              18078,07,11,12,22,30,03,06,
              18079,03,04,10,27,29,01,05,
              18080,07,16,24,26,31,10,11,
              18081,02,10,13,21,35,01,12,
              18082,01,02,14,17,18,08,10,
              18083,07,12,25,27,28,10,11,
              18084,06,11,17,22,35,11,12,
              18085,01,02,14,25,31,05,07,
              18086,16,22,24,29,31,04,05,
              18087,03,14,19,23,25,01,04,
              18088,08,09,21,25,33,01,08,
              18089,26,27,28,32,34,06,10,
              18090,06,20,24,33,34,04,11,
              18091,06,22,26,28,31,01,07,
              18092,05,07,14,18,19,04,10,
              18093,03,11,16,18,33,03,11,
              18094,11,16,25,30,34,08,10,
              18095,07,14,18,29,35,05,12,
              18096,13,14,20,28,34,06,10,
              18097,10,12,14,18,23,01,04,
              18098,02,15,18,25,27,05,07,
              18099,12,13,16,20,21,01,07,
              18100,06,20,21,26,30,06,09,
              18101,03,14,15,23,29,04,05,
              18102,06,07,13,22,24,10,12,
              18103,14,24,26,28,35,02,03,
              18104,01,13,14,26,28,07,11,
              18105,01,16,19,20,31,02,07,
              18106,04,14,17,24,31,01,04,
              18107,07,08,09,10,22,03,04,
              18108,09,10,24,31,32,07,12,
              18109,10,16,23,25,34,02,05,
              18110,06,19,21,27,28,03,11,
              18111,03,16,27,28,32,04,05,
              18112,03,07,08,09,29,03,10,
              18113,08,12,27,31,33,04,05,
              18114,12,18,26,28,29,05,06,
              18115,02,06,13,18,25,01,02,
              18116,01,14,17,21,33,07,10,
              18117,07,11,13,22,29,03,08,
              18118,04,05,14,21,34,06,09,
              18119,06,09,11,16,35,02,05,
              18120,21,22,25,27,30,08,09,
              18121,06,07,21,29,30,01,10,
              18122,08,09,21,30,31,05,12,
              18123,06,09,29,32,35,02,04,
              18124,08,10,12,19,20,10,11,
              18125,07,16,20,21,34,04,06,
              18126,11,13,15,21,27,05,06,
              18127,01,03,04,11,29,08,12,
              18128,11,12,14,16,26,08,09,
              18129,04,07,21,22,29,03,06,
              18130,03,04,16,18,25,01,11,
              18131,12,14,21,32,33,02,11,
              18132,03,16,22,23,27,01,04,
              18133,08,12,14,15,19,01,10,
              18134,04,05,19,31,35,02,12,
              18135,14,19,23,27,34,06,12,
              18136,03,11,12,19,21,05,11,
              18137,07,10,22,23,33,08,11,
              18138,01,23,24,28,33,04,05,
              18139,05,11,16,28,35,06,09,
              18140,01,06,08,12,15,03,04,
              18141,03,07,23,26,33,04,09,
              18142,19,24,28,29,34,10,11,
              18143,04,07,20,22,33,01,02,
              18144,06,17,18,24,31,07,11,
              18145,09,18,29,31,33,06,11,
              18146,03,08,09,13,33,01,02,
              18147,01,11,26,33,35,02,10,
              18148,02,06,24,33,34,02,03,
              18149,01,07,10,11,20,03,06,
              18150,05,12,13,31,34,10,12,
              18151,04,08,18,29,30,03,07,
              18152,02,04,05,12,28,08,11,
              18153,03,06,07,08,21,01,08,
              18154,14,22,23,26,30,03,05
              )
m_2018<-matrix(cell_2018,ncol = 8,byrow = TRUE,dimnames = list(cnames,rnames))
cell_2019<-c( 19001,06,18,23,26,28,03,12,
              19002,02,07,14,22,31,01,07,
              19003,04,08,18,20,32,10,12,
              19004,15,16,17,31,32,03,09,
              19005,15,16,17,31,32,03,09,
              19006,14,17,19,25,30,04,08,
              19007,03,12,16,29,32,01,05,
              19008,03,08,17,20,24,06,11,
              19009,03,09,15,18,26,06,12,
              19010,03,07,24,25,27,02,12,
              19011,04,12,13,16,17,04,09,
              19012,05,09,17,18,19,07,10,
              19013,08,10,15,17,18,01,08,
              19014,12,14,20,28,31,09,11,
              19015,02,05,10,13,30,04,06,
              19016,03,05,13,16,28,02,06,
              19017,01,05,07,22,25,03,04,
              19018,03,18,19,26,34,06,12,
              19019,04,11,19,25,32,01,02,
              19020,01,08,16,27,34,03,12,
              19021,07,13,17,24,33,01,10,
              19022,01,04,14,15,21,01,05,
              19023,01,03,14,26,30,06,11,
              19024,11,17,19,29,33,08,09,
              19025,06,13,16,19,29,03,07,
              19026,10,12,15,17,19,02,03,
              19027,16,18,24,25,27,02,07,
              19028,06,22,28,29,33,02,07,
              19029,01,04,18,24,28,02,03,
              19030,07,09,13,14,33,02,04,
              19031,03,08,21,26,33,04,05,
              19032,01,04,07,11,30,07,08,
              19033,01,02,04,16,24,07,09,
              19034,08,12,15,27,30,01,02,
              19035,01,03,05,07,18,08,09,
              19036,03,09,21,28,30,01,12,
              19037,06,16,26,33,35,04,08,
              19038,05,11,16,18,27,07,12,
              19039,01,12,18,26,35,06,12,
              19040,01,03,31,32,34,01,03,
              19041,12,19,20,22,28,02,06,
              19042,04,10,13,28,33,11,12,
              19043,02,06,07,12,15,06,12,
              19044,03,06,10,12,31,01,02,
              19045,01,04,16,19,33,03,12,
              19046,02,08,14,15,35,10,12,
              19047,03,04,10,16,32,04,09,
              19048,06,10,16,29,33,05,11,
              19049,10,16,22,26,27,07,11,
              19050,04,15,16,20,35,03,12,
              19051,11,15,16,20,29,04,08,
              19052,04,10,15,20,24,07,11,
              19053,01,11,19,26,35,11,12,
              19054,02,18,23,27,30,05,10,
              19055,02,04,06,19,22,02,06,
              19056,01,07,10,12,23,06,08,
              19057,08,14,16,34,35,06,12,
              19058,03,10,13,14,32,07,11,
              19059,07,08,15,27,32,08,12,
              19060,01,11,12,18,21,08,10,
              19061,01,02,13,14,26,05,11,
              19062,05,16,23,25,28,01,12,
              19063,05,08,15,18,21,04,08,
              19064,07,08,13,19,29,11,12,
              19065,03,08,10,23,27,02,12,
              19066,04,10,11,18,31,05,08,
              19067,03,08,11,15,16,02,10,
              19068,04,05,08,17,27,06,11,
              19069,08,22,23,33,34,04,06,
              19070,02,13,15,22,34,02,12,
              19071,07,13,14,15,22,07,11,
              19072,02,04,06,09,18,07,10,
              19073,04,11,19,20,24,08,11,
              19074,08,09,13,14,34,05,07,
              19075,05,06,07,11,16,02,11,
              19076,01,06,11,23,29,01,11,
              19077,01,15,17,21,33,07,10,
              19078,05,10,21,26,30,01,07,
              19079,10,13,16,28,35,04,05,
              19080,05,13,18,19,24,02,07,
              19081,06,24,26,30,33,02,07,
              19082,06,18,20,21,31,03,04,
              19083,17,24,26,28,32,07,09,
              19084,12,23,25,34,35,01,07,
              19085,04,05,06,15,26,08,11,
              19086,05,15,16,28,31,02,07,
              19087,05,06,18,19,27,07,12,
              19088,01,05,18,27,33,06,08,
              19089,09,14,18,33,34,03,12,
              19090,13,19,28,30,33,02,12,
              19091,01,13,20,26,28,03,12,
              19092,02,11,15,27,30,02,05,
              19093,16,17,26,29,35,01,07,
              19094,01,12,14,26,27,07,09,
              19095,03,12,17,19,31,02,06,
              19096,02,12,22,23,27,02,06,
              19097,10,17,20,30,35,10,12,
              19098,13,15,17,19,22,03,04,
              19099,04,06,18,27,33,07,09,
              19100,05,08,12,19,21,06,11,
              19101,05,11,18,19,27,05,06,
              19102,05,10,15,19,31,03,06,
              19103,05,12,22,27,32,04,07,
              19104,02,07,19,22,28,03,05,
              19105,01,04,09,14,17,01,06,
              19106,05,08,10,32,35,02,10,
              19107,05,09,19,27,35,02,03,
              19108,24,27,28,31,34,04,08,
              19109,02,07,08,20,25,11,12,
              19110,01,19,23,24,30,04,05,
              19111,06,15,20,23,27,08,10,
              19112,03,10,16,21,33,05,06,
              19113,03,11,27,34,35,01,02,
              19114,03,05,07,20,23,04,11,
              19115,01,18,21,28,32,05,12,
              19116,02,10,16,21,23,02,12,
              19117,01,18,21,25,35,07,08,
              19118,02,03,13,19,26,02,03,
              19119,03,06,09,23,34,02,11,
              19120,06,15,17,22,25,01,09,
              19121,01,02,03,07,17,04,10,
              19122,05,19,25,31,33,10,11,
              19123,03,13,15,26,30,05,12,
              19124,07,17,26,27,30,06,12,
              19125,05,08,09,14,34,02,05,
              19126,05,09,16,18,30,04,07,
              19127,04,07,08,11,16,09,11,
              19128,20,21,25,34,35,03,12,
              19129,10,13,18,23,30,06,12,
              19130,01,13,20,21,26,04,10,
              19131,05,06,14,27,29,06,10,
              19132,03,05,06,13,18,10,12,
              19133,03,12,24,27,34,01,12,
              19134,05,06,07,14,17,10,11,
              19135,04,05,19,25,26,01,11,
              19136,03,16,20,26,29,03,09,
              19137,03,05,12,13,26,07,12,
              19138,04,06,07,20,29,02,04,
              19139,01,05,07,08,11,06,10,
              19140,03,07,08,25,27,03,05,
              19141,02,10,20,21,35,01,12,
              19142,03,04,26,29,33,06,07,
              19143,04,22,23,24,32,06,12,
              19144,02,05,20,28,31,02,11,
              19145,05,09,19,22,32,03,05,
              19146,10,11,26,33,34,01,06,
              19147,09,12,19,22,33,07,08,
              19148,03,04,07,11,30,08,09,
              19149,01,02,07,33,35,06,10,
              19150,07,11,12,16,33,05,07
              
              
              )
m_2019<-matrix(cell_2019,ncol = 8,byrow = TRUE,dimnames = list(cnames,rnames))
cell_2020<-c(20001,17,25,26,32,34,04,07,
             20002,03,07,18,25,30,02,07,
             20003,23,25,26,30,34,03,07,
             20004,17,20,21,29,30,05,09,
             20005,06,10,33,34,35,01,03,
             20006,09,22,25,31,32,08,12,
             20007,02,10,19,24,30,05,08,
             20008,14,17,19,24,32,01,06,
             20011,02,13,19,22,23,02,07,
             20012,01,06,18,32,34,01,03
             )
m_2020<-matrix(cell_2020,ncol = 8,byrow = TRUE,dimnames = list(cnames,rnames))
cell_all<-c(cell_2015,
            cell_2016,
            cell_2017,
            cell_2018,
            cell_2019,
            cell_2020)
m_all<-matrix(cell_all,ncol = 8,byrow = TRUE,dimnames = list(cnames,rnames))
#edit(m_2017)
length(m_all)
dim(m_all)
str(m_all)
class(m_all)
mode(m_all)
names(m_all)
#fix(m_all)

#dev.new()
#plot(cell_2015)
summary(m_all)
#dev.new()
#hist(m_2017)

#remove NA value
m_all<-na.omit(m_all)
#build dta.frame
n<-m_all[,1]
a1<-m_all[,2]
a2<-m_all[,3]
a3<-m_all[,4]
a4<-m_all[,5]
a5<-m_all[,6]
#apply(x,marMARGIN,FUN,...)
sa<-apply(m_all[,2:6],1,sum,na.rm=TRUE)
dsa<-c(0,diff(sa))
b1<-m_all[,7]
b2<-m_all[,8]
sb<-apply(m_all[,7:8],1,sum)
dsb<-c(0,diff(sb))
dlt<- data.frame(n,a1,a2,a3,a4,a5,sa,b1,b2,sb,dsa,dsb)
apply(dlt,2,mean)
dlt_sa<-scale(dlt[,2:6])
dlt_sb<-scale(dlt[9:10])
dlt_sas<-apply(dlt_sa,1,sum)
dlt_sam<-apply(dlt_sa,1,mean)
dlt_sbs<-apply(dlt_sb,1,sum)
dlt_sbm<-apply(dlt_sb,1,mean)
dlt_s<-cbind(n,dlt_sa,dlt_sam,dlt_sas,dlt_sb,dlt_sbm,dlt_sbs)
dlt_s<-as.data.frame(dlt_s)
apply(m_2017[,2:6],2,describe)
stat.desc(dlt)

a_sm<-describe(t(m_2017[,2:6]))
b_sm<-describe(t(m_all[,7:8]))

#table
a_f<-table(m_all[,2:6]) 
b_f<-table(m_all[,7:8])
#percentage
#ab_f<-cbind(m_all[,1:8],prop.table(m_all[,2:8])*100)

ab_s_f<-as.data.frame(table(dlt$sa,dlt$sb)) 
sa=ab_s_f$Var1
sb=ab_s_f$Var2
Freq=ab_s_f$Freq
ab_s_f<-data.frame(sa,sb,Freq)
dlt<-merge(dlt,ab_s_f,by=c("sa","sb"))
dlt<-dlt[order(dlt$n),]
m_all<-as.matrix(dlt[1:10])
ab_s_m<-as.data.frame.matrix ( xtabs(~dlt$sa+dlt$sb,data = dlt)) 
#xtabs(~dlt$sa+dlt$sb+dlt$dsa+dlt$dsb,data = dlt)
#margnual number
mar_table(m_2017[,2:6])
margin.table(m_2017[,2:6],1)#row sum
margin.table(m_2017[,2:6],2)#colum sum
#proportion
prop.table(m_2017[,2:6],2)
mar_table(prop.table(m_2017[,2:6]))
addmargins(prop.table(m_2017[,2:6]),c(1,2))
#mar_table(prop.table(m_2017[,2:6],1))
#mar_table(prop.table(m_2017[,2:6],2))

plot(table(dlt$sa,dlt$sb))
barplot( table(m_2017[,2:6]))
barplot( table(m_2017[,7:8]))

CrossTable(tail(dlt$sa),tail(dlt$sb),chisq =  TRUE,fisher = TRUE,mcnemar = FALSE)
#relationship(p < 0.01)
chisq.test(table(m_all[,9:10]))
assocstats(x = m_all[,9:10])
kappa(m_all[,9:10])
#without relationship(p > 0.05)
chisq.test(table(m_all[,4:8]))
assocstats(x = m_all[,4:8])
kappa(m_all[,4:8])

chisq.test(table(m_all[,4:10]))
assocstats(x = m_all[,4:10])
kappa(m_all[,4:10])

dim(dlt)

#Correlation, Variance and Covariance (Matrices)
cora<-cor(t(m_all[,4:8]))
#pearson
cora_pearson<-cor(t(m_all[,4:8]),method = "pearson")
#spearman
cora_spearman<-cor(t(m_all[,4:8]),method = "spearman")


#Variance & Covariance
cova<-cov(t(m_all[,4:8]))
#Partial correlation
pcor(c(1,2),cov(t(m_all[,-3])))
#alternative 
cor.test(x = t(m_all[3,4:8]),y = t(m_all[10,4:8]),alternative = "greater",method = "pearson")

#dlt<-data.frame(dlt$sa,dlt$sb,dlt$n,dlt$a1,dlt$a2,dlt$a3,dlt$a4,dlt$a5,dlt$b1,dlt$b2,dlt$dsa,dlt$dsb,dlt$Freq)

#print(Matrix(as.matrix(dlt),sparse=T))


dlt_a_numeric<-dlt[,4:8]
dlt_numeric<-dlt[,4:10]
dlt_a_unit<-preProcess(dlt_a_numeric,method = c("range"))
dlt_a_numeric_unit<-predict(dlt_a_unit,dlt_a_numeric)
dlt_a_zscore<-preProcess(dlt_a_numeric,method = c("center","scale"))
dlt_a_numeric_zscore<-predict(dlt_a_zscore,dlt_a_numeric)   
dlt_a_boxcox<-preProcess(dlt_a_numeric,method = c("BoxCox"))
dlt_a_numeric_boxcox<-predict(dlt_a_boxcox,dlt_a_numeric)
dlt_a_pca<-preProcess(dlt_a_numeric,method = c("BoxCox","center","scale","pca"),thresh = 0.95)
dlt_a_numeric_pca<-predict(dlt_a_pca,dlt_a_numeric)
pp_a_pca_full<-preProcess(dlt_a_numeric,method = c("BoxCox","center","scale","pca"),pcaComp = 4)
dlt_a_pca_full<-predict(pp_a_pca_full,dlt_a_numeric)
pp_pca_var<-apply(dlt_a_pca_full,2,var)
dlt_a_pca_var<-data.frame(Variance=
                            round(100*pp_pca_var/sum(pp_pca_var),2),CumulativeVariance=
                            round(100*cumsum(pp_pca_var)/sum(pp_pca_var),2))

findCorrelation(cor(dlt[,4:8]))
findCorrelation(cor(dlt[,9:10]))
describe(dlt)
cor(dlt[,4:8])
cor(dlt[,9:10])
nearZeroVar(dlt[,4:8],saveMetrics = TRUE)
dlt_a_pca_var

trans<-preProcess(dlt_numeric,method = c("BoxCox","center","scale","pca"))
#implement transformed
transformed<-predict(trans,dlt_numeric)
#filter
nearZeroVar(dlt_numeric)
#correlations
correlations<-cor(dlt_numeric)
dim(correlations)

library(corrplot)
corrplot(correlations,order = "hclust")

highCorr<-findCorrelation(correlations,cutoff = 0.5)
filtereddlt_numeric<-dlt_numeric[,highCorr]




data<-dlt
count<-dim(dlt)[1]


write.csv(dlt,file = "dlt.csv")
print(tail(dlt,1))


  
