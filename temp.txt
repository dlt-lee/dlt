> #clu:
> sort(table(data.xgb.clu$a1.clu))

 3 11 18  4  5  6  8 
 1  1  1  2  2  4  5 
> sort(table(data.xgb.clu$a2.clu))

10 12 14 15 19 18 20 16 17 
 1  1  1  1  1  2  2  3  4 
> sort(table(data.xgb.clu$a3.clu))

13 14 17 18 19 20 11 12 15 16 
 1  1  1  1  1  1  2  2  2  4 
> sort(table(data.xgb.clu$a4.clu))

15 16 21 25 11 19 20 22 18 
 1  1  1  1  2  2  2  2  4 
> sort(table(data.xgb.clu$a5.clu))

27 30 34 25 31 26 28 29 
 1  1  1  2  2  3  3  3 
> sort(table(data.xgb.clu$b1.clu))

6 9 4 8 5 
1 2 3 4 6 
> sort(table(data.xgb.clu$b2.clu))

 7 10 11  8  9 
 2  2  2  3  7 
> #row:
> sort(table(data.xgb.row$a1.row))

 2  4  5 11 10  8  9  7 
 1  1  1  1  2  3  3  4 
> sort(table(data.xgb.row$a2.row))

 7  8 10 12 15 16 17 18  9 11 13 14 
 1  1  1  1  1  1  1  1  2  2  2  2 
> sort(table(data.xgb.row$a3.row))

13 24 25 15 16 17 14 
 1  1  1  2  3  3  5 
> sort(table(data.xgb.row$a4.row))

14 18 20 21 24 26 28 19 23 25 
 1  1  1  1  1  1  1  2  3  4 
> sort(table(data.xgb.row$a5.row))

20 23 31 32 33 25 27 28 30 29 
 1  1  1  1  1  2  2  2  2  3 
> sort(table(data.xgb.row$b1.row))

7 8 6 5 4 
2 2 3 4 5 
> sort(table(data.xgb.row$b2.row))

10  7  8  9 
 2  4  4  6 
> #clu.row:
> sort(table(data.xgb.clu.row.aver$a1))

 0  5  7 10  3  6  4 
 1  1  2  2  3  3  4 
> sort(table(data.xgb.clu.row.aver$a2))

15 17 19  9 11 16 14 12 
 1  1  1  2  2  2  3  4 
> sort(table(data.xgb.clu.row.aver$a3))

17 19 21 25 14 18 20 22 23 
 1  1  1  1  2  2  2  2  4 
> sort(table(data.xgb.clu.row.aver$a4))

15 23 24 29 32 18 25 27 28 26 
 1  1  1  1  1  2  2  2  2  3 
> sort(table(data.xgb.clu.row.aver$a5))

28 29 31 33 34 32 30 
 1  1  1  1  2  4  6 
> sort(table(data.xgb.clu.row.aver$b1))

2 6 3 4 5 
1 2 4 4 5 
> sort(table(data.xgb.clu.row.aver$b2))

 3  7 12 13  8 11 10 
 1  1  1  1  2  4  6 
> #row.row:
> sort(table(data.xgb.row.row.aver$a1))

 1  4  6 10 14  5  9 11  7 
 1  1  1  1  1  2  2  2  5 
> sort(table(data.xgb.row.row.aver$a2))

10 15 16 18  8  9 14 11 12 
 1  1  1  1  2  2  2  3  3 
> sort(table(data.xgb.row.row.aver$a3))

18 20 29 15 17 21 22 23 16 
 1  1  1  2  2  2  2  2  3 
> sort(table(data.xgb.row.row.aver$a4))

16 18 22 24 27 19 20 21 25 23 
 1  1  1  1  1  2  2  2  2  3 
> sort(table(data.xgb.row.row.aver$a5))

21 32 25 27 31 30 29 
 1  1  2  2  2  3  5 
> sort(table(data.xgb.row.row.aver$b1))

3 4 5 6 7 
2 2 3 3 6 
> sort(table(data.xgb.row.row.aver$b2))

11  5  8  9 10  6 
 1  2  3  3  3  4 
> 
> 
> data.xgb.clu.clu
[1]  5 13 19 26 31  5 11
> data.rdf.clu.clu
 1  1  1  1  1  1  1 
 5 12 17 25 31  5 10 
> data.xgb.row.clu
[1]  1 10 24 29 30  1 10
> data.xgb.clu.row
[1] 13 13 14 12 19  4  6
> data.xgb.row.row
[1] 14  7 20 17 20  3  4
> data.xgb.clu.cum
   a1 a2 a3 a4 a5 b1 b2
1   4 13 16 30 32  3  9
2   4 13 16 30 32  3  9
3   4 13 16 30 32  3  9
4   4 13 16 30 32  3  9
5   4 13 16 30 32  3  9
6   4 13 16 30 32  3  9
7   4 13 16 30 32  3  9
8   4 13 16 30 32  3  9
9   4 13 16 30 32  3  9
10  4 13 16 30 32  3  9
11  4 13 16 30 32  3  9
12  4 13 16 30 32  3  9
13  4 13 16 30 32  3  9
14  4 13 16 30 32  3  9
15  4 13 16 30 32  3  9
16  4 13 16 30 32  3  9
> data.xgb.row.cum
   a1 a2 a3 a4 a5 b1 b2
1   2  8 24 25 33  2 11
2   2  8 24 25 33  2 11
3   2  8 24 25 33  2 11
4   2  8 24 25 33  2 11
5   2  8 24 25 33  2 11
6   2  8 24 25 33  2 11
7   2  8 24 25 33  2 11
8   2  8 24 25 33  2 11
9   2  8 24 25 33  2 11
10  2  8 24 25 33  2 11
11  2  8 24 25 33  2 11
12  2  8 24 25 33  2 11
13  2  8 24 25 33  2 11
14  2  8 24 25 33  2 11
15  2  8 24 25 33  2 11
16  2  8 24 25 33  2 11
> 
> data.xgb.clu.clu.a<-sort(data.xgb.clu.clu[1:5])
> data.xgb.clu.clu.b<-sort(data.xgb.clu.clu[6:7])
> 
> data.rdf.clu.clu.a<-sort(as.numeric(data.rdf.clu.clu[1:5]))
> data.rdf.clu.clu.b<-sort(as.numeric(data.rdf.clu.clu[6:7]))
> 
> data.xgb.row.clu.a<-sort(data.xgb.row.clu[1:5])
> data.xgb.row.clu.b<-sort(data.xgb.row.clu[6:7])
> 
> data.xgb.clu.row.a<-sort(data.xgb.clu.row[1:5])
> data.xgb.clu.row.b<-sort(data.xgb.clu.row[6:7])
> 
> data.xgb.row.row.a<-sort(data.xgb.row.row[1:5])
> data.xgb.row.row.b<-sort(data.xgb.row.row[6:7])
> 
> r.a1<-c(data.xgb.clu.clu.a[1],data.rdf.clu.clu.a[1],data.xgb.row.clu.a[1],data.xgb.clu.row.a[1],
+         data.xgb.row.row.a[1],data.xgb.clu.cum$a1,data.xgb.row.cum$a1)
> r.a2<-c(data.xgb.clu.clu.a[2],data.rdf.clu.clu.a[2],data.xgb.row.clu.a[2],data.xgb.clu.row.a[2],
+         data.xgb.row.row.a[2],data.xgb.clu.cum$a2,data.xgb.row.cum$a2)
> r.a3<-c(data.xgb.clu.clu.a[3],data.rdf.clu.clu.a[3],data.xgb.row.clu.a[3],data.xgb.clu.row.a[3],
+         data.xgb.row.row.a[3],data.xgb.clu.cum$a3,data.xgb.row.cum$a3)
> r.a4<-c(data.xgb.clu.clu.a[4],data.rdf.clu.clu.a[4],data.xgb.row.clu.a[4],data.xgb.clu.row.a[4],
+         data.xgb.row.row.a[4],data.xgb.clu.cum$a4,data.xgb.row.cum$a4)
> r.a5<-c(data.xgb.clu.clu.a[5],data.rdf.clu.clu.a[5],data.xgb.row.clu.a[5],data.xgb.clu.row.a[5],
+         data.xgb.row.row.a[5],data.xgb.clu.cum$a5,data.xgb.row.cum$a5)
> r.b1<-c(data.xgb.clu.clu.b[1],data.rdf.clu.clu.b[1],data.xgb.row.clu.b[1],data.xgb.clu.row.b[1],
+         data.xgb.row.row.b[1],data.xgb.clu.cum$b1,data.xgb.row.cum$b1)
> r.b2<-c(data.xgb.clu.clu.b[2],data.rdf.clu.clu.b[2],data.xgb.row.clu.b[2],data.xgb.clu.row.b[2],
+         data.xgb.row.row.b[2],data.xgb.clu.cum$b2,data.xgb.row.cum$b2)
> 
> sort(table(r.a1))
r.a1
 1  7 12  5  2  4 
 1  1  1  2 16 16 
> sort(table(r.a2))
r.a2
10 12 14  8 13 
 1  1  1 16 18 
> sort(table(r.a3))
r.a3
13 19 17 16 24 
 1  1  2 16 17 
> sort(table(r.a4))
r.a4
14 20 26 29 30 25 
 1  1  1  1 16 17 
> sort(table(r.a5))
r.a5
19 20 30 31 32 33 
 1  1  1  2 16 16 
> sort(table(r.b1))
r.b1
 1  4  5  2  3 
 1  1  2 16 17 
> sort(table(r.b2))
r.b2
 4  6 10  9 11 
 1  1  2 16 17 
> ########################################################################################################
> #train.sa<-head(dlt$sa,dim(dlt)[1]-1)
> #train.sb<-head(dlt$sb,dim(dlt)[1]-1)
> #result.sa<-tail(dlt$sa,dim(dlt)[1]-1)
> #result.sb<-tail(dlt$sb,dim(dlt)[1]-1)
> 
> #train
> sa.1<-dlt$sa[1:(dim(dlt)[1]-3)]
> sa.2<-dlt$sa[2:(dim(dlt)[1]-2)]
> sa.3<-dlt$sa[3:(dim(dlt)[1]-1)]
> result.sa<-dlt$sa[4:dim(dlt)[1]]
> trains.sa<-data.frame(sa.1,sa.2,sa.3,result.sa)
> trains.T.sa<-Matrix(as.matrix(trains.sa[,1:3]),sparse=T)
> bst.sa<-xgboost(data = trains.T.sa,label = trains.sa$result.sa,nrounds = 300,print_every_n = 300L)
[1]	train-rmse:65.473824 
[300]	train-rmse:0.146550 
> 
> 
> sb.1<-dlt$sb[1:(dim(dlt)[1]-3)]
> sb.2<-dlt$sb[2:(dim(dlt)[1]-2)]
> sb.3<-dlt$sb[3:(dim(dlt)[1]-1)]
> result.sb<-dlt$sb[4:dim(dlt)[1]]
> trains.sb<-data.frame(sb.1,sb.2,sb.3,result.sb)
> trains.T.sb<-Matrix(as.matrix(trains.sb[,1:3]),sparse=T)
> bst.sb<-xgboost(data = trains.T.sb,label = trains.sb$result.sb,nrounds = 300,print_every_n = 300L)
[1]	train-rmse:10.032938 
[300]	train-rmse:1.012826 
> 
> #predoct
> sa.1<-dlt$sa[2:(dim(dlt)[1]-2)]
> sa.2<-dlt$sa[3:(dim(dlt)[1]-1)]
> sa.3<-dlt$sa[4:dim(dlt)[1]]
> tests.sa<-data.frame(sa.1,sa.2,sa.3)
> tests.T.sa<-Matrix(as.matrix(tests.sa),sparse=T)
> testPredictions.sa <- predict(object = bst.sa,newdata = tests.T.sa)
> 
> sb.1<-dlt$sb[2:(dim(dlt)[1]-2)]
> sb.2<-dlt$sb[3:(dim(dlt)[1]-1)]
> sb.3<-dlt$sb[4:dim(dlt)[1]]
> tests.sb<-data.frame(sb.1,sb.2,sb.3)
> tests.T.sb<-Matrix(as.matrix(tests.sb),sparse=T)
> testPredictions.sb <- predict(object = bst.sb,newdata = tests.T.sb)
> 
> sa.pre<-round(testPredictions.sa)
> sb.pre<-round(testPredictions.sb)
> 
> c(tail(sa.pre,1),tail(sb.pre,1))
[1] 96 10





> #clu:
> sort(table(data.xgb.clu$a1.clu))

5 4 8 6 7 
1 3 3 4 5 
> sort(table(data.xgb.clu$a2.clu))

 9 10 14 18 11 15 16 12 13 
 1  1  1  1  2  2  2  3  3 
> sort(table(data.xgb.clu$a3.clu))

 9 10 17 21 23 31 15 19 14 18 
 1  1  1  1  1  1  2  2  3  3 
> sort(table(data.xgb.clu$a4.clu))

19 23 24 26 28 16 17 21 22 18 
 1  1  1  1  1  2  2  2  2  3 
> sort(table(data.xgb.clu$a5.clu))

29 34 31 30 32 33 
 1  1  2  3  4  5 
> sort(table(data.xgb.clu$b1.clu))

8 7 4 5 6 
1 3 4 4 4 
> sort(table(data.xgb.clu$b2.clu))

11  7  8 10  9 
 1  2  3  4  6 
> #row:
> sort(table(data.xgb.row$a1.row))

2 8 9 3 5 4 6 
1 1 1 2 3 4 4 
> sort(table(data.xgb.row$a2.row))

10 11  9 14  8 13 12 
 1  1  2  2  3  3  4 
> sort(table(data.xgb.row$a3.row))

20 22 11 15 16 19 14 17 
 1  1  2  2  2  2  3  3 
> sort(table(data.xgb.row$a4.row))

15 17 19 24 30 18 21 22 23 20 
 1  1  1  1  1  2  2  2  2  3 
> sort(table(data.xgb.row$a5.row))

34 36 31 32 33 
 1  1  4  5  5 
> sort(table(data.xgb.row$b1.row))

3 5 7 4 6 
1 2 2 5 6 
> sort(table(data.xgb.row$b2.row))

 7  8 10  9 
 1  4  5  6 
> #clu.row:
> sort(table(data.xgb.clu.row.aver$a1))

 3  7  9 10  4  6 11  5  8 
 1  1  1  1  2  2  2  3  3 
> sort(table(data.xgb.clu.row.aver$a2))

11 12 13 20 10 17 14  8 
 1  1  1  1  2  2  3  5 
> sort(table(data.xgb.clu.row.aver$a3))

 9 14 17 18 20 22 21 24 16 19 
 1  1  1  1  1  1  2  2  3  3 
> sort(table(data.xgb.clu.row.aver$a4))

17 21 23 24 26 27 30 31 34 18 29 
 1  1  1  1  1  1  1  1  1  2  5 
> sort(table(data.xgb.clu.row.aver$a5))

28 33 34 36 27 30 31 32 
 1  1  1  1  2  2  4  4 
> sort(table(data.xgb.clu.row.aver$b1))

6 2 3 5 4 
1 3 3 4 5 
> sort(table(data.xgb.clu.row.aver$b2))

 6  4  5  9 11 10  7 
 1  2  2  2  2  3  4 
> #row.row:
> sort(table(data.xgb.row.row.aver$a1))

 3 11  4  7  8 10  5  6 
 1  1  2  2  2  2  3  3 
> sort(table(data.xgb.row.row.aver$a2))

 7  8 10 16 21 12 14 11  9 
 1  1  1  1  1  2  2  3  4 
> sort(table(data.xgb.row.row.aver$a3))

12 13 16 19 20 14 15 18 21 22 
 1  1  1  1  1  2  2  2  2  3 
> sort(table(data.xgb.row.row.aver$a4))

17 18 21 29 20 22 25 26 28 31 
 1  1  1  1  2  2  2  2  2  2 
> sort(table(data.xgb.row.row.aver$a5))

21 25 28 29 30 24 31 33 34 35 
 1  1  1  1  1  2  2  2  2  3 
> sort(table(data.xgb.row.row.aver$b1))

1 9 4 3 7 5 
1 1 2 3 4 5 
> sort(table(data.xgb.row.row.aver$b2))

 4 11 12 13  7  8  9  6 
 1  1  1  1  2  2  3  5 
> 
> 
> data.xgb.clu.clu
[1]  3  9 11 20 28  3  6
> data.rdf.clu.clu
 1  1  1  1  1  1  1 
 5 12 17 23 28  4  8 
> data.xgb.row.clu
[1]  8 16 22 24 27  6  3
> data.xgb.clu.row
[1] 16 16 13 10 20  2  4
> data.xgb.row.row
[1]  4  7 13 14 15  2  5
> data.xgb.clu.cum
   a1 a2 a3 a4 a5 b1 b2
1   4 11 14 19 28  1  7
2   4 11 14 19 28  2  7
3   4 11 14 19 28  1  7
4   4 11 14 19 28  1  7
5   4 11 14 19 28  2  7
6   4 12 14 19 28  2  7
7   4 11 14 19 28  1  7
8   4 11 14 19 28  1  7
9   4 12 14 19 28  1  7
10  4 12 14 19 28  1  7
11  4 12 14 19 28  1  7
12  4 12 14 19 28  1  7
13  4 11 14 19 28  1  7
14  4 12 14 19 28  1  7
15  4 12 14 19 28  1  7
16  4 11 14 19 28  1  7
> data.xgb.row.cum
   a1 a2 a3 a4 a5 b1 b2
1  10 15 27 23 28  7  6
2  10 15 27 23 28  7  6
3  10 15 27 23 28  7  6
4  10 15 27 23 28  7  6
5  10 15 27 23 28  7  6
6  10 15 27 23 28  7  6
7  10 15 27 23 28  7  6
8  10 15 27 23 28  7  6
9  10 15 27 23 28  7  6
10 10 15 27 23 28  7  6
11 10 15 27 23 28  7  6
12 10 15 27 23 28  7  6
13 10 15 27 23 28  7  6
14 10 15 27 23 28  7  6
15 10 15 27 23 28  7  6
16 10 15 27 23 28  7  6
> 
> data.xgb.clu.clu.a<-sort(data.xgb.clu.clu[1:5])
> data.xgb.clu.clu.b<-sort(data.xgb.clu.clu[6:7])
> 
> data.rdf.clu.clu.a<-sort(as.numeric(data.rdf.clu.clu[1:5]))
> data.rdf.clu.clu.b<-sort(as.numeric(data.rdf.clu.clu[6:7]))
> 
> data.xgb.row.clu.a<-sort(data.xgb.row.clu[1:5])
> data.xgb.row.clu.b<-sort(data.xgb.row.clu[6:7])
> 
> data.xgb.clu.row.a<-sort(data.xgb.clu.row[1:5])
> data.xgb.clu.row.b<-sort(data.xgb.clu.row[6:7])
> 
> data.xgb.row.row.a<-sort(data.xgb.row.row[1:5])
> data.xgb.row.row.b<-sort(data.xgb.row.row[6:7])
> 
> r.a1<-c(data.xgb.clu.clu.a[1],data.rdf.clu.clu.a[1],data.xgb.row.clu.a[1],data.xgb.clu.row.a[1],
+         data.xgb.row.row.a[1],data.xgb.clu.cum$a1,data.xgb.row.cum$a1)
> r.a2<-c(data.xgb.clu.clu.a[2],data.rdf.clu.clu.a[2],data.xgb.row.clu.a[2],data.xgb.clu.row.a[2],
+         data.xgb.row.row.a[2],data.xgb.clu.cum$a2,data.xgb.row.cum$a2)
> r.a3<-c(data.xgb.clu.clu.a[3],data.rdf.clu.clu.a[3],data.xgb.row.clu.a[3],data.xgb.clu.row.a[3],
+         data.xgb.row.row.a[3],data.xgb.clu.cum$a3,data.xgb.row.cum$a3)
> r.a4<-c(data.xgb.clu.clu.a[4],data.rdf.clu.clu.a[4],data.xgb.row.clu.a[4],data.xgb.clu.row.a[4],
+         data.xgb.row.row.a[4],data.xgb.clu.cum$a4,data.xgb.row.cum$a4)
> r.a5<-c(data.xgb.clu.clu.a[5],data.rdf.clu.clu.a[5],data.xgb.row.clu.a[5],data.xgb.clu.row.a[5],
+         data.xgb.row.row.a[5],data.xgb.clu.cum$a5,data.xgb.row.cum$a5)
> r.b1<-c(data.xgb.clu.clu.b[1],data.rdf.clu.clu.b[1],data.xgb.row.clu.b[1],data.xgb.clu.row.b[1],
+         data.xgb.row.row.b[1],data.xgb.clu.cum$b1,data.xgb.row.cum$b1)
> r.b2<-c(data.xgb.clu.clu.b[2],data.rdf.clu.clu.b[2],data.xgb.row.clu.b[2],data.xgb.clu.row.b[2],
+         data.xgb.row.row.b[2],data.xgb.clu.cum$b2,data.xgb.row.cum$b2)
> 
> sort(table(r.a1))
r.a1
 3  5  8  4 10 
 1  1  1 17 17 
> sort(table(r.a2))
r.a2
 7  9 13 16 12 11 15 
 1  1  1  1  8  9 16 
> sort(table(r.a3))
r.a3
11 13 16 17 22 14 27 
 1  1  1  1  1 16 16 
> sort(table(r.a4))
r.a4
14 16 20 24 19 23 
 1  1  1  1 16 17 
> sort(table(r.a5))
r.a5
15 20 27 28 
 1  1  1 34 
> sort(table(r.b1))
r.b1
 4  3  2  1  7 
 1  2  5 13 16 
> sort(table(r.b2))
r.b2
 4  5  8  7  6 
 1  1  1 16 18 
> ########################################################################################################
> #train.sa<-head(dlt$sa,dim(dlt)[1]-1)
> #train.sb<-head(dlt$sb,dim(dlt)[1]-1)
> #result.sa<-tail(dlt$sa,dim(dlt)[1]-1)
> #result.sb<-tail(dlt$sb,dim(dlt)[1]-1)
> 
> #train
> sa.1<-dlt$sa[1:(dim(dlt)[1]-3)]
> sa.2<-dlt$sa[2:(dim(dlt)[1]-2)]
> sa.3<-dlt$sa[3:(dim(dlt)[1]-1)]
> result.sa<-dlt$sa[4:dim(dlt)[1]]
> trains.sa<-data.frame(sa.1,sa.2,sa.3,result.sa)
> trains.T.sa<-Matrix(as.matrix(trains.sa[,1:3]),sparse=T)
> bst.sa<-xgboost(data = trains.T.sa,label = trains.sa$result.sa,nrounds = 300,print_every_n = 300L)
[1]	train-rmse:65.466942 
[300]	train-rmse:0.149784 
> 
> 
> sb.1<-dlt$sb[1:(dim(dlt)[1]-3)]
> sb.2<-dlt$sb[2:(dim(dlt)[1]-2)]
> sb.3<-dlt$sb[3:(dim(dlt)[1]-1)]
> result.sb<-dlt$sb[4:dim(dlt)[1]]
> trains.sb<-data.frame(sb.1,sb.2,sb.3,result.sb)
> trains.T.sb<-Matrix(as.matrix(trains.sb[,1:3]),sparse=T)
> bst.sb<-xgboost(data = trains.T.sb,label = trains.sb$result.sb,nrounds = 300,print_every_n = 300L)
[1]	train-rmse:10.035871 
[300]	train-rmse:1.017989 
> 
> #predoct
> sa.1<-dlt$sa[2:(dim(dlt)[1]-2)]
> sa.2<-dlt$sa[3:(dim(dlt)[1]-1)]
> sa.3<-dlt$sa[4:dim(dlt)[1]]
> tests.sa<-data.frame(sa.1,sa.2,sa.3)
> tests.T.sa<-Matrix(as.matrix(tests.sa),sparse=T)
> testPredictions.sa <- predict(object = bst.sa,newdata = tests.T.sa)
> 
> sb.1<-dlt$sb[2:(dim(dlt)[1]-2)]
> sb.2<-dlt$sb[3:(dim(dlt)[1]-1)]
> sb.3<-dlt$sb[4:dim(dlt)[1]]
> tests.sb<-data.frame(sb.1,sb.2,sb.3)
> tests.T.sb<-Matrix(as.matrix(tests.sb),sparse=T)
> testPredictions.sb <- predict(object = bst.sb,newdata = tests.T.sb)
> 
> sa.pre<-round(testPredictions.sa)
> sb.pre<-round(testPredictions.sb)
> 
> c(tail(sa.pre,1),tail(sb.pre,1))
[1] 57 10
> 

