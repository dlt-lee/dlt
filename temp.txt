> #clu:
> sort(table(data.xgb.clu$a1.clu))

 0  1  4 10 11  3  8  6  5 
 1  1  1  1  1  2  2  3  4 
> sort(table(data.xgb.clu$a2.clu))

17 10 12 13  9 11 15 
 1  2  2  2  3  3  3 
> sort(table(data.xgb.clu$a3.clu))

10 11 15 16 20 21 18 19 17 
 1  1  1  1  1  1  2  2  6 
> sort(table(data.xgb.clu$a4.clu))

14 16 21 22 23 24 25 27 19 20 17 
 1  1  1  1  1  1  1  1  2  2  4 
> sort(table(data.xgb.clu$a5.clu))

19 28 35 25 31 23 26 29 
 1  1  1  2  2  3  3  3 
> sort(table(data.xgb.clu$b1.clu))

2 4 5 3 
1 3 3 9 
> sort(table(data.xgb.clu$b2.clu))

 6 11  5 10  8  9  7 
 1  1  2  2  3  3  4 
> #row:
> sort(table(data.xgb.row$a1.row))

 2  8  9 15 12  5 11  6 
 1  1  1  1  2  3  3  4 
> sort(table(data.xgb.row$a2.row))

 8 10 14 18 11 12 13 
 1  1  1  1  3  4  5 
> sort(table(data.xgb.row$a3.row))

12 15 19 23 16 17 14 
 1  1  2  2  3  3  4 
> sort(table(data.xgb.row$a4.row))

19 24 22 26 20 21 23 
 1  1  2  2  3  3  4 
> sort(table(data.xgb.row$a5.row))

19 24 27 23 25 22 26 
 1  1  1  2  3  4  4 
> sort(table(data.xgb.row$b1.row))

4 5 2 3 
1 1 7 7 
> sort(table(data.xgb.row$b2.row))

 6  9 11 10  8 
 1  1  1  6  7 
> #clu.row:
> sort(table(data.xgb.clu.row.aver$a1))

 1  3  9 10  2  4  7  5  8 
 1  1  1  1  2  2  2  3  3 
> sort(table(data.xgb.clu.row.aver$a2))

 4  7  8  9 10 11 14 15 17 18 25 13 
 1  1  1  1  1  1  1  1  1  1  1  5 
> sort(table(data.xgb.clu.row.aver$a3))

11 12 21 22 24 16 18 19 17 
 1  1  1  1  1  2  2  3  4 
> sort(table(data.xgb.clu.row.aver$a4))

18 21 25 27 28 31 32 19 22 26 23 
 1  1  1  1  1  1  1  2  2  2  3 
> sort(table(data.xgb.clu.row.aver$a5))

21 23 27 28 32 25 30 34 29 
 1  1  1  1  1  2  2  2  5 
> sort(table(data.xgb.clu.row.aver$b1))

3 4 8 2 7 6 5 
1 1 1 2 2 3 6 
> sort(table(data.xgb.clu.row.aver$b2))

 6 10 12  9  7  8 11 
 1  1  1  2  3  3  5 
> #row.row:
> sort(table(data.xgb.row.row.aver$a1))

 0  3  6  7 10  2  4  5  8 
 1  1  1  1  1  2  3  3  3 
> sort(table(data.xgb.row.row.aver$a2))

 3  5  7  9 15  8 10 12 11 
 1  1  1  1  1  2  2  2  5 
> sort(table(data.xgb.row.row.aver$a3))

 1  9 10 15 19 20 22 25 11 12 13 21 
 1  1  1  1  1  1  1  1  2  2  2  2 
> sort(table(data.xgb.row.row.aver$a4))

10 14 17 24 30 33 19 20 21 22 25 
 1  1  1  1  1  1  2  2  2  2  2 
> sort(table(data.xgb.row.row.aver$a5))

15 21 26 37 25 29 30 32 28 
 1  1  1  1  2  2  2  2  4 
> sort(table(data.xgb.row.row.aver$b1))

 0  1  2 10  5  6  7  4 
 1  1  1  1  2  3  3  4 
> sort(table(data.xgb.row.row.aver$b2))

 4  6  8  5  7  9 10 13 11 
 1  1  1  2  2  2  2  2  3 
> 
> 
> data.xgb.clu.clu
[1]  5 13 15 25 28  3  8
> data.rdf.clu.clu
 1  1  1  1  1  1  1 
 6 12 15 25 27  3  8 
> data.xgb.row.clu
[1]  3 11  7 17 29  2  4
> data.xgb.clu.row
[1]  5 19 14 11 10  5  4
> data.xgb.row.row
[1]  5 19 16 12 25  4  5
> data.xgb.clu.cum
   a1 a2 a3 a4 a5 b1 b2
1  10 12 10 25 26  3  8
2  10 12 10 26 26  3  8
3  10 12 10 26 26  3  8
4  10 12 10 26 26  3  8
5  10 12 10 26 26  3  8
6  10 12 10 26 26  3  8
7  10 12 10 26 26  3  8
8  10 12 10 26 26  3  8
9  10 12 10 26 26  3  8
10 10 12 10 25 26  3  8
11 10 12 10 25 26  3  8
12 10 12 10 25 26  3  8
13 10 12 10 25 26  3  8
14 10 12 10 25 26  3  8
15 10 12 10 25 26  3  8
16 10 12 10 26 26  3  8
> data.xgb.row.cum
   a1 a2 a3 a4 a5 b1 b2
1   5  9 13 23 30  7  4
2   5  9 13 23 30  7  4
3   5  9 13 23 30  7  4
4   5  9 13 23 30  7  4
5   5  9 13 23 30  7  4
6   5  9 13 23 30  7  4
7   5  9 13 23 30  7  4
8   5  9 13 23 30  7  4
9   5  9 13 23 30  7  4
10  5  9 13 23 30  7  4
11  5  9 13 23 30  7  4
12  5  9 13 23 30  7  4
13  5  9 13 23 30  7  4
14  5  9 13 23 30  7  4
15  5  9 13 23 30  7  4
16  5  9 13 23 30  7  4
> 
> data.xgb.clu.clu.a<-sort(data.xgb.clu.clu[1:5])
> data.xgb.clu.clu.b<-sort(data.xgb.clu.clu[6:7])
> 
> data.rdf.clu.clu.a<-sort(as.numeric(data.rdf.clu.clu[1:5]))
> data.rdf.clu.clu.b<-sort(as.numeric(data.rdf.clu.clu[6:7]))
> 
> data.xgb.row.clu.a<-sort(data.xgb.row.clu[1:5])
> data.xgb.row.clu.b<-sort(data.xgb.row.clu[6:7])
> 
> data.xgb.clu.row.a<-sort(data.xgb.clu.row[1:5])
> data.xgb.clu.row.b<-sort(data.xgb.clu.row[6:7])
> 
> data.xgb.row.row.a<-sort(data.xgb.row.row[1:5])
> data.xgb.row.row.b<-sort(data.xgb.row.row[6:7])
> 
> r.a1<-c(data.xgb.clu.clu.a[1],data.rdf.clu.clu.a[1],data.xgb.row.clu.a[1],data.xgb.clu.row.a[1],
+         data.xgb.row.row.a[1],data.xgb.clu.cum$a1)
> r.a2<-c(data.xgb.clu.clu.a[2],data.rdf.clu.clu.a[2],data.xgb.row.clu.a[2],data.xgb.clu.row.a[2],
+         data.xgb.row.row.a[2],data.xgb.clu.cum$a2)
> r.a3<-c(data.xgb.clu.clu.a[3],data.rdf.clu.clu.a[3],data.xgb.row.clu.a[3],data.xgb.clu.row.a[3],
+         data.xgb.row.row.a[3],data.xgb.clu.cum$a3)
> r.a4<-c(data.xgb.clu.clu.a[4],data.rdf.clu.clu.a[4],data.xgb.row.clu.a[4],data.xgb.clu.row.a[4],
+         data.xgb.row.row.a[4],data.xgb.clu.cum$a4)
> r.a5<-c(data.xgb.clu.clu.a[5],data.rdf.clu.clu.a[5],data.xgb.row.clu.a[5],data.xgb.clu.row.a[5],
+         data.xgb.row.row.a[5],data.xgb.clu.cum$a5)
> r.b1<-c(data.xgb.clu.clu.b[1],data.rdf.clu.clu.b[1],data.xgb.row.clu.b[1],data.xgb.clu.row.b[1],
+         data.xgb.row.row.b[1],data.xgb.clu.cum$b1)
> r.b2<-c(data.xgb.clu.clu.b[2],data.rdf.clu.clu.b[2],data.xgb.row.clu.b[2],data.xgb.clu.row.b[2],
+         data.xgb.row.row.b[2],data.xgb.clu.cum$b2)
> 
> sort(table(r.a1))
r.a1
 3  6  5 10 
 1  1  3 16 
> sort(table(r.a2))
r.a2
 7 10 13 12 
 1  1  1 18 
> sort(table(r.a3))
r.a3
16 11 15 10 
 1  2  2 16 
> sort(table(r.a4))
r.a4
14 17 19 25 26 
 1  1  1  9  9 
> sort(table(r.a5))
r.a5
19 25 27 28 29 26 
 1  1  1  1  1 16 
> sort(table(r.b1))
r.b1
 2  4  3 
 1  2 18 
> sort(table(r.b2))
r.b2
 4  5  8 
 1  2 18 
> ########################################################################################################
> #train.sa<-head(dlt$sa,dim(dlt)[1]-1)
> #train.sb<-head(dlt$sb,dim(dlt)[1]-1)
> #result.sa<-tail(dlt$sa,dim(dlt)[1]-1)
> #result.sb<-tail(dlt$sb,dim(dlt)[1]-1)
> 
> #train
> sa.1<-dlt$sa[1:(dim(dlt)[1]-3)]
> sa.2<-dlt$sa[2:(dim(dlt)[1]-2)]
> sa.3<-dlt$sa[3:(dim(dlt)[1]-1)]
> result.sa<-dlt$sa[4:dim(dlt)[1]]
> trains.sa<-data.frame(sa.1,sa.2,sa.3,result.sa)
> trains.T.sa<-Matrix(as.matrix(trains.sa[,1:3]),sparse=T)
> bst.sa<-xgboost(data = trains.T.sa,label = trains.sa$result.sa,nrounds = 300,print_every_n = 300L)
[1]	train-rmse:65.759293 
[300]	train-rmse:0.118118 
> 
> 
> sb.1<-dlt$sb[1:(dim(dlt)[1]-3)]
> sb.2<-dlt$sb[2:(dim(dlt)[1]-2)]
> sb.3<-dlt$sb[3:(dim(dlt)[1]-1)]
> result.sb<-dlt$sb[4:dim(dlt)[1]]
> trains.sb<-data.frame(sb.1,sb.2,sb.3,result.sb)
> trains.T.sb<-Matrix(as.matrix(trains.sb[,1:3]),sparse=T)
> bst.sb<-xgboost(data = trains.T.sb,label = trains.sb$result.sb,nrounds = 300,print_every_n = 300L)
[1]	train-rmse:10.003492 
[300]	train-rmse:1.002801 
> 
> #predoct
> sa.1<-dlt$sa[2:(dim(dlt)[1]-2)]
> sa.2<-dlt$sa[3:(dim(dlt)[1]-1)]
> sa.3<-dlt$sa[4:dim(dlt)[1]]
> tests.sa<-data.frame(sa.1,sa.2,sa.3)
> tests.T.sa<-Matrix(as.matrix(tests.sa),sparse=T)
> testPredictions.sa <- predict(object = bst.sa,newdata = tests.T.sa)
> 
> sb.1<-dlt$sb[2:(dim(dlt)[1]-2)]
> sb.2<-dlt$sb[3:(dim(dlt)[1]-1)]
> sb.3<-dlt$sb[4:dim(dlt)[1]]
> tests.sb<-data.frame(sb.1,sb.2,sb.3)
> tests.T.sb<-Matrix(as.matrix(tests.sb),sparse=T)
> testPredictions.sb <- predict(object = bst.sb,newdata = tests.T.sb)
> 
> sa.pre<-round(testPredictions.sa)
> sb.pre<-round(testPredictions.sb)
> 
> c(tail(sa.pre,1),tail(sb.pre,1))
[1] 49 11


> #clu:
> sort(table(data.xgb.clu$a1.clu))

6 7 4 3 5 
1 1 3 5 6 
> sort(table(data.xgb.clu$a2.clu))

 7  9 10 
 1  6  9 
> sort(table(data.xgb.clu$a3.clu))

13 14 18 15 17 19 16 
 1  1  1  2  3  3  5 
> sort(table(data.xgb.clu$a4.clu))

19 21 22 17 20 23 24 28 25 
 1  1  1  2  2  2  2  2  3 
> sort(table(data.xgb.clu$a5.clu))

24 28 31 32 34 30 29 33 
 1  1  1  1  1  2  4  5 
> sort(table(data.xgb.clu$b1.clu))

 2  6 11  4  5  7  3 
 1  1  1  3  3  3  4 
> sort(table(data.xgb.clu$b2.clu))

 2  6 11  4  5  7  8  9 
 1  1  1  2  2  3  3  3 
> #row:
> sort(table(data.xgb.row$a1.row))

7 3 4 6 9 5 
1 2 3 3 3 4 
> sort(table(data.xgb.row$a2.row))

 4  7 15 11 12 10 
 1  1  1  4  4  5 
> sort(table(data.xgb.row$a3.row))

12 20 21 14 16 23 17 19 
 1  1  1  2  2  2  3  4 
> sort(table(data.xgb.row$a4.row))

19 21 26 22 25 27 24 23 
 1  1  1  2  2  2  3  4 
> sort(table(data.xgb.row$a5.row))

24 25 26 27 30 32 33 31 28 29 
 1  1  1  1  1  1  1  2  3  4 
> sort(table(data.xgb.row$b1.row))

5 7 2 6 3 4 
1 1 2 2 4 6 
> sort(table(data.xgb.row$b2.row))

 6 11  7  9 10  8 
 1  1  2  2  2  8 
> #clu.row:
> sort(table(data.xgb.clu.row.aver$a1))

 5  6  7  9 10  2  3  4 
 1  1  1  1  1  3  4  4 
> sort(table(data.xgb.clu.row.aver$a2))

13  6 10 15 16 11  8 
 1  2  2  2  2  3  4 
> sort(table(data.xgb.clu.row.aver$a3))

10 11 14 16 17 22 24 29 19 15 18 
 1  1  1  1  1  1  1  1  2  3  3 
> sort(table(data.xgb.clu.row.aver$a4))

17 18 19 20 21 27 24 25 22 23 
 1  1  1  1  1  1  2  2  3  3 
> sort(table(data.xgb.clu.row.aver$a5))

24 29 31 34 35 27 33 32 30 
 1  1  1  1  1  2  2  3  4 
> sort(table(data.xgb.clu.row.aver$b1))

-1  0  1  6  7  4  8  3  2 
 1  1  1  1  1  2  2  3  4 
> sort(table(data.xgb.clu.row.aver$b2))

 5  9 14 11 13  8  6 
 1  1  1  2  2  4  5 
> #row.row:
> sort(table(data.xgb.row.row.aver$a1))

 1  2  8 11  3  4  7  5  6 
 1  1  1  1  2  2  2  3  3 
> sort(table(data.xgb.row.row.aver$a2))

 7  8 11 19  4  6  9 12 13 16 
 1  1  1  1  2  2  2  2  2  2 
> sort(table(data.xgb.row.row.aver$a3))

13 18 22 16 20 14 15 17 
 1  1  1  2  2  3  3  3 
> sort(table(data.xgb.row.row.aver$a4))

20 21 24 26 28 29 23 25 19 22 
 1  1  1  1  1  1  2  2  3  3 
> sort(table(data.xgb.row.row.aver$a5))

24 25 28 29 31 32 30 
 1  1  1  2  2  4  5 
> sort(table(data.xgb.row.row.aver$b1))

0 2 7 3 5 4 6 
1 1 1 2 3 4 4 
> sort(table(data.xgb.row.row.aver$b2))

 6  7 12 11  8  9 10 
 1  1  1  2  3  3  5 
> 
> 
> data.xgb.clu.clu
[1]  2  9 13 27 31  7 10
> data.rdf.clu.clu
 1  1  1  1  1  1  1 
 4 10 16 25 30  5  8 
> data.xgb.row.clu
[1]  6  7 19 21 30  4  7
> data.xgb.clu.row
[1] 10  8 13 21 25  2  3
> data.xgb.row.row
[1]  5  7 10 12 17  5  4
> data.xgb.clu.cum
   a1 a2 a3 a4 a5 b1 b2
1   6 11 19 28 30  7 11
2   6 11 20 28 30  7 11
3   6 11 19 28 30  7 11
4   6 11 19 28 30  7 11
5   6 11 19 28 30  7 11
6   6 11 19 28 30  7 11
7   6 11 19 28 30  7 11
8   6 11 19 28 30  7 11
9   6 11 19 28 30  7 11
10  6 11 19 28 30  7 11
11  6 11 19 28 30  7 11
12  6 11 19 28 30  7 11
13  6 11 19 28 30  7 11
14  6 11 19 28 30  7 11
15  6 11 19 28 30  7 11
16  6 11 19 28 30  7 11
> data.xgb.row.cum
   a1 a2 a3 a4 a5 b1 b2
1   8 10 15 24 32  5  9
2   8 10 15 24 32  5  9
3   8 10 15 24 32  5  9
4   8 10 15 24 32  5  9
5   8 10 15 24 32  5  9
6   8 10 15 24 32  5  9
7   8 10 15 24 32  5  9
8   8 10 15 24 32  5  9
9   8 10 15 24 32  5  9
10  8 10 15 24 32  5  9
11  8 10 15 24 32  5  9
12  8 10 15 24 32  5  9
13  8 10 15 24 32  5  9
14  8 10 15 24 32  5  9
15  8 10 15 24 32  5  9
16  8 10 15 24 32  5  9
> 
> data.xgb.clu.clu.a<-sort(data.xgb.clu.clu[1:5])
> data.xgb.clu.clu.b<-sort(data.xgb.clu.clu[6:7])
> 
> data.rdf.clu.clu.a<-sort(as.numeric(data.rdf.clu.clu[1:5]))
> data.rdf.clu.clu.b<-sort(as.numeric(data.rdf.clu.clu[6:7]))
> 
> data.xgb.row.clu.a<-sort(data.xgb.row.clu[1:5])
> data.xgb.row.clu.b<-sort(data.xgb.row.clu[6:7])
> 
> data.xgb.clu.row.a<-sort(data.xgb.clu.row[1:5])
> data.xgb.clu.row.b<-sort(data.xgb.clu.row[6:7])
> 
> data.xgb.row.row.a<-sort(data.xgb.row.row[1:5])
> data.xgb.row.row.b<-sort(data.xgb.row.row[6:7])
> 
> r.a1<-c(data.xgb.clu.clu.a[1],data.rdf.clu.clu.a[1],data.xgb.row.clu.a[1],data.xgb.clu.row.a[1],
+         data.xgb.row.row.a[1],data.xgb.clu.cum$a1)
> r.a2<-c(data.xgb.clu.clu.a[2],data.rdf.clu.clu.a[2],data.xgb.row.clu.a[2],data.xgb.clu.row.a[2],
+         data.xgb.row.row.a[2],data.xgb.clu.cum$a2)
> r.a3<-c(data.xgb.clu.clu.a[3],data.rdf.clu.clu.a[3],data.xgb.row.clu.a[3],data.xgb.clu.row.a[3],
+         data.xgb.row.row.a[3],data.xgb.clu.cum$a3)
> r.a4<-c(data.xgb.clu.clu.a[4],data.rdf.clu.clu.a[4],data.xgb.row.clu.a[4],data.xgb.clu.row.a[4],
+         data.xgb.row.row.a[4],data.xgb.clu.cum$a4)
> r.a5<-c(data.xgb.clu.clu.a[5],data.rdf.clu.clu.a[5],data.xgb.row.clu.a[5],data.xgb.clu.row.a[5],
+         data.xgb.row.row.a[5],data.xgb.clu.cum$a5)
> r.b1<-c(data.xgb.clu.clu.b[1],data.rdf.clu.clu.b[1],data.xgb.row.clu.b[1],data.xgb.clu.row.b[1],
+         data.xgb.row.row.b[1],data.xgb.clu.cum$b1)
> r.b2<-c(data.xgb.clu.clu.b[2],data.rdf.clu.clu.b[2],data.xgb.row.clu.b[2],data.xgb.clu.row.b[2],
+         data.xgb.row.row.b[2],data.xgb.clu.cum$b2)
> 
> sort(table(r.a1))
r.a1
 2  4  5  8  6 
 1  1  1  1 17 
> sort(table(r.a2))
r.a2
 9  7 10 11 
 1  2  2 16 
> sort(table(r.a3))
r.a3
10 16 20 13 19 
 1  1  1  2 16 
> sort(table(r.a4))
r.a4
12 25 27 21 28 
 1  1  1  2 16 
> sort(table(r.a5))
r.a5
17 25 31 30 
 1  1  1 18 
> sort(table(r.b1))
r.b1
 2  5  4  7 
 1  1  2 17 
> sort(table(r.b2))
r.b2
 3  5  7  8 10 11 
 1  1  1  1  1 16 
> ########################################################################################################
> #train.sa<-head(dlt$sa,dim(dlt)[1]-1)
> #train.sb<-head(dlt$sb,dim(dlt)[1]-1)
> #result.sa<-tail(dlt$sa,dim(dlt)[1]-1)
> #result.sb<-tail(dlt$sb,dim(dlt)[1]-1)
> 
> #train
> sa.1<-dlt$sa[1:(dim(dlt)[1]-3)]
> sa.2<-dlt$sa[2:(dim(dlt)[1]-2)]
> sa.3<-dlt$sa[3:(dim(dlt)[1]-1)]
> result.sa<-dlt$sa[4:dim(dlt)[1]]
> trains.sa<-data.frame(sa.1,sa.2,sa.3,result.sa)
> trains.T.sa<-Matrix(as.matrix(trains.sa[,1:3]),sparse=T)
> bst.sa<-xgboost(data = trains.T.sa,label = trains.sa$result.sa,nrounds = 300,print_every_n = 300L)
[1]	train-rmse:65.740303 
[300]	train-rmse:0.145562 
> 
> 
> sb.1<-dlt$sb[1:(dim(dlt)[1]-3)]
> sb.2<-dlt$sb[2:(dim(dlt)[1]-2)]
> sb.3<-dlt$sb[3:(dim(dlt)[1]-1)]
> result.sb<-dlt$sb[4:dim(dlt)[1]]
> trains.sb<-data.frame(sb.1,sb.2,sb.3,result.sb)
> trains.T.sb<-Matrix(as.matrix(trains.sb[,1:3]),sparse=T)
> bst.sb<-xgboost(data = trains.T.sb,label = trains.sb$result.sb,nrounds = 300,print_every_n = 300L)
[1]	train-rmse:10.008163 
[300]	train-rmse:1.005402 
> 
> #predoct
> sa.1<-dlt$sa[2:(dim(dlt)[1]-2)]
> sa.2<-dlt$sa[3:(dim(dlt)[1]-1)]
> sa.3<-dlt$sa[4:dim(dlt)[1]]
> tests.sa<-data.frame(sa.1,sa.2,sa.3)
> tests.T.sa<-Matrix(as.matrix(tests.sa),sparse=T)
> testPredictions.sa <- predict(object = bst.sa,newdata = tests.T.sa)
> 
> sb.1<-dlt$sb[2:(dim(dlt)[1]-2)]
> sb.2<-dlt$sb[3:(dim(dlt)[1]-1)]
> sb.3<-dlt$sb[4:dim(dlt)[1]]
> tests.sb<-data.frame(sb.1,sb.2,sb.3)
> tests.T.sb<-Matrix(as.matrix(tests.sb),sparse=T)
> testPredictions.sb <- predict(object = bst.sb,newdata = tests.T.sb)
> 
> sa.pre<-round(testPredictions.sa)
> sb.pre<-round(testPredictions.sb)
> 
> c(tail(sa.pre,1),tail(sb.pre,1))
[1] 117  20
> 